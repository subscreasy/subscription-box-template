<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>subscriptionBoxTemplate</title>
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/fonts/font-awesome.min.css">
    <link rel="stylesheet" href="assets/fonts/ionicons.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Actor">
    <link rel="stylesheet" href="assets/css/Bootstrap-Payment-Form.css">
    <link rel="stylesheet" href="assets/css/Footer-Dark.css">
    <link rel="stylesheet" href="assets/css/Login-Form-Clean.css">
    <link rel="stylesheet" href="assets/css/Navigation-with-Button.css">
    <link rel="stylesheet" href="assets/css/Pretty-Product-List.css">
    <link rel="stylesheet" href="assets/css/Product-Details.css">
    <link rel="stylesheet" href="assets/css/Profile-Card.css">
    <link rel="stylesheet" href="assets/css/Profile-Edit-Form-1.css">
    <link rel="stylesheet" href="assets/css/Profile-Edit-Form.css">
    <link rel="stylesheet" href="assets/css/Registration-Form-with-Photo.css">
    <link rel="stylesheet" href="assets/css/styles.css">

    <script type="text/javascript" src="bundle.js"></script>
</head>

<script type="text/javascript">

    function offer(){
        this.name;
        this.openEnded;
        this.price;
        this.company;
        this.recurrence;
    }

    function company(){
        this.name;
    }

    function recurrence() {
        this.length;
        this.recurrenceType;
    }

    function paymentCard() {
        this.cardNumber;
        this.cvc;
        this.expireMonth;
        this.expireYear;
    }

    function subscriber() {
        this.company;
        this.name;
        this.surname;
        this.email;
        this.shippingName;
        this.shippingCity;
        this.shippingCountry;
        this.shippingZipCode;
    }

    function checkout() {
        console.log("checkout method entered");

        //**********offer*******************
        var companyInstance = new company();
        companyInstance.name = "Browsymous";

        var recurrenceInstance = new recurrence();
        recurrenceInstance.length = 5;
        recurrenceInstance.recurrenceType = "DAILY";

        var offerInstance = new offer();
        offerInstance.name = "denemename";
        offerInstance.openEnded = false;
        offerInstance.price = 100;
        offerInstance.company = companyInstance;
        offerInstance.recurrence = recurrenceInstance;
        //**********offer*******************

        //**********paymentCard********************
        var paymentCardInstance = new paymentCard();
        paymentCardInstance.cardNumber = $("[name='paymentCard.cardNumber']").val();
        paymentCardInstance.cvc = $("[name='paymentCard.cvc']").val();
        // TODO expiredate inputtan split işlemi yapılcak.
        paymentCardInstance.expireMonth = "11";
        paymentCardInstance.expireYear = "22";
        //**********paymentCard********************

        //**********subscriber********************
        var subscriberInstance = new subscriber();
        subscriberInstance.company = companyInstance;
        subscriberInstance.name = $("[name='subscriber.name']").val();
        subscriberInstance.surname = $("[name='subscriber.surname']").val();
        subscriberInstance.email = $("[name='subscriber.email']").val();
        subscriberInstance.shippingName = $("[name='subscriber.shippingName']").val();
        //TODO shippingname ve shippingcountry verileri alınacak.
        subscriberInstance.shippingCity = $("[name='subscriber.shippingCity']").val();
        subscriberInstance.shippingZipCode = $("[name='subscriber.shippingZipCode']").val();
        //**********subscriber********************

        console.log(offerInstance);
        console.log(paymentCardInstance);
        console.log(subscriberInstance);

        var startSubscriptionVM = startSubscriptionFunc(subscriberInstance, paymentCardInstance, offerInstance);

        var callback = function (error, data, response) {
            if (error) {
                document.getElementById("errorPlaceholder").innerText = response.text;
            } else {
                document.getElementById("errorPlaceholder").innerText = "Subscription started";
            }
        };
        subsriptionResourceApi.startSubscriptionUsingPOST(startSubscriptionVM,callback);
    }
</script>

<body onload="bodyOnLoad();">
    <div>
        <nav class="navbar navbar-light navbar-expand-md navigation-clean-button">
            <div class="container"><a class="navbar-brand" href="#">Company Name</a><button class="navbar-toggler" data-toggle="collapse" data-target="#navcol-1"><span class="sr-only">Toggle navigation</span><span class="navbar-toggler-icon"></span></button>
                <div class="collapse navbar-collapse"
                    id="navcol-1">
                    <ul class="nav navbar-nav mr-auto">
                        <li class="nav-item" role="presentation"><a class="nav-link active" href="#">First Item</a></li>
                        <li class="nav-item" role="presentation"><a class="nav-link" href="#">Second Item</a></li>
                        <li class="dropdown"><a class="dropdown-toggle nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" href="#">User</a>
                            <div class="dropdown-menu" role="menu"><a class="dropdown-item" role="presentation" href="userProfile.html">Profile</a><a class="dropdown-item" role="presentation" href="#">Second Item</a><a class="dropdown-item" role="presentation" href="#">Third Item</a></div>
                        </li>
                    </ul><span class="navbar-text actions" id="loginSpan"> <a href="login.html" class="login">Log In</a><a class="btn btn-light action-button" role="button" href="signUp.html">Sign Up</a></span><span class="navbar-text" id="logoutSpan"><button class="btn btn-light" type="button" onclick="logout();">Logout</button></span></div>
            </div>
        </nav>
    </div>
    <div style="background-color:rgb(241,247,252);">
        <form method="post" action="javascript:checkout()">
            <div class="form-row">
                <div class="col-6 offset-3" style="padding:10px;padding-top:20px;">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">Subscription Details</h5>
                        </div>
                        <div class="card-body">
                            <div class="form-row">
                                <div class="col"><label class="col-form-label">Browsymous Tester Edition 3 Minutes</label></div>
                            </div>
                            <hr>
                            <div class="form-row">
                                <div class="col"><label class="col-form-label">Price</label></div>
                                <div class="col"><label class="col-form-label">0,99 TL</label></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-row">
                <div class="col-6 offset-3" style="padding:10px;">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">Subscriber Details</h5>
                        </div>
                        <div class="card-body">
                            <div class="form-row">
                                <div class="col">
                                    <div class="form-group"><label>Name</label><input class="form-control" type="text" name="subscriber.name" autocomplete="additional-name"></div>
                                </div>
                                <div class="col">
                                    <div class="form-group"><label>Surname</label><input class="form-control" type="text" name="subscriber.surname" autocomplete="family-name"></div>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="col">
                                    <div class="form-group"><label>Email</label><input class="form-control" type="email" name="subscriber.email" autocomplete="email"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-row">
                <div class="col-6 offset-3" style="padding:10px;">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">Shipping Information</h5>
                        </div>
                        <div class="card-body">
                            <div class="form-row">
                                <div class="col">
                                    <div class="form-group"><label>Name, Surname *</label><input class="form-control" type="text" name="subscriber.shippingName" autocomplete="name"></div>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="col">
                                    <div class="form-group"><label>Shipping Address *</label><input class="form-control" type="text" name="subscriber.shippingAddress" autocomplete="address-line1"></div>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="col">
                                    <div class="form-group"><label>City *</label><input class="form-control" type="text" name="subscriber.shippingCity" autocomplete="address-level2"></div>
                                </div>
                                <div class="col">
                                    <div class="form-group"><label>Country *</label><select class="form-control" name="subscriber.shippingCountry" autocomplete="country-name"><optgroup label="This is a group"><option value="12" selected="">Turkey</option><option value="13">This is item 2</option><option value="14">This is item 3</option></optgroup></select></div>
                                </div>
                                <div class="col">
                                    <div class="form-group"><label>ZIP Code *</label><input class="form-control" type="text" name="subscriber.shippingZipCode" autocomplete="postal-code"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-row .payment-dialog-row">
                <div class="col-12 col-md-4 offset-md-4" style="padding:10px;padding-bottom:20px;">
                    <div class="card credit-card-box">
                        <div class="card-header">
                            <h6 class="mb-0"><span class="panel-title-text">Payment Details </span><img class="img-fluid panel-title-image" src="assets/img/accepted_cards.png"></h6>
                        </div>
                        <div class="card-body">
                            <div class="form-row">
                                <div class="col-12">
                                    <div class="form-group"><label for="cardNumber">Card number </label>
                                        <div class="input-group"><input class="form-control" type="tel" name="paymentCard.cardNumber" required="" placeholder="Valid Card Number" id="cardNumber" autocomplete="cc-number">
                                            <div class="input-group-append"><span class="input-group-text"><i class="fa fa-credit-card"></i></span></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="col-7">
                                    <div class="form-group"><label for="cardExpiry"><span>Expiration </span>Date</label><input class="form-control" type="tel" name="expirationDate" required="" placeholder="MM / YY" id="cardExpiry" autocomplete="cc-exp"></div>
                                </div>
                                <div class="col-5 pull-right">
                                    <div class="form-group"><label for="cardCVC">CV Code</label><input class="form-control" type="tel" name="paymentCard.cvc" required="" placeholder="CVC" id="cardCVC" autocomplete="cc-csc"></div>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="col-12"><button class="btn btn-success btn-block btn-lg" type="submit">Start Subscription</button></div>
                                <label id = "errorPlaceholder"></label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
    <div class="footer-dark">
        <footer>
            <div class="container">
                <div class="row">
                    <div class="col-sm-6 col-md-3 item">
                        <h3>Services</h3>
                        <ul>
                            <li><a href="#">Web design</a></li>
                            <li><a href="#">Development</a></li>
                            <li><a href="#">Hosting</a></li>
                        </ul>
                    </div>
                    <div class="col-sm-6 col-md-3 item">
                        <h3>About</h3>
                        <ul>
                            <li><a href="#">Company</a></li>
                            <li><a href="#">Team</a></li>
                            <li><a href="#">Careers</a></li>
                        </ul>
                    </div>
                    <div class="col-md-6 item text">
                        <h3>Company Name</h3>
                        <p>Praesent sed lobortis mi. Suspendisse vel placerat ligula. Vivamus ac sem lacus. Ut vehicula rhoncus elementum. Etiam quis tristique lectus. Aliquam in arcu eget velit pulvinar dictum vel in justo.</p>
                    </div>
                    <div class="col item social"><a href="#"><i class="icon ion-social-facebook"></i></a><a href="#"><i class="icon ion-social-twitter"></i></a><a href="#"><i class="icon ion-social-snapchat"></i></a><a href="#"><i class="icon ion-social-instagram"></i></a></div>
                </div>
                <p class="copyright">Company Name © 2017</p>
            </div>
        </footer>
    </div>

    <script type="text/javascript">
        if (!isLoggedInFunc()) {
            document.location.href = "login.html";
        }
    </script>

    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="assets/js/custom.js"></script>
    <script src="assets/js/Profile-Edit-Form.js"></script>
</body>

</html>